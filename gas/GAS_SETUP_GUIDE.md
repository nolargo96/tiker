# Google Apps Script セットアップガイド

このガイドでは、ポートフォリオダッシュボードをGASで自動実行し、スマホからアクセスできるように設定します。

## 📋 必要なもの

- Googleアカウント
- GitHubアカウント（オプション：データ連携する場合）

## 🚀 セットアップ手順

### 1. GASプロジェクトの作成

1. [Google Apps Script](https://script.google.com) にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を「ポートフォリオダッシュボード」に変更

### 2. コードのデプロイ

#### ファイル構成
```
📁 ポートフォリオダッシュボード
├── 📄 Code.gs      (メインコード)
└── 📄 index.html   (Webアプリ画面)
```

#### 手順：
1. `Code.gs` の内容を貼り付け
2. ファイル → 新規作成 → HTML で `index.html` を作成
3. `index.html` の内容を貼り付け

### 3. Webアプリとして公開

1. デプロイ → 新しいデプロイ
2. 種類：「ウェブアプリ」を選択
3. 設定：
   - 説明：「ポートフォリオダッシュボード v1」
   - 実行ユーザー：「自分」
   - アクセス：「自分のみ」
4. デプロイをクリック
5. 表示されたURLを保存（スマホでアクセスするURL）

### 4. 定期実行の設定

GASエディタで以下を実行：
```javascript
setupTriggers();
```

これにより：
- 毎日朝9時にデータ更新
- 4時間ごとにデータ更新

### 5. スマホでのアクセス

1. デプロイ時に取得したURLをスマホのブラウザで開く
2. ブックマークに追加
3. ホーム画面に追加（オプション）

## 📱 使い方

### 基本機能
- **自動更新**: 定期的に最新データを取得
- **手動更新**: 画面右下の更新ボタン
- **投資判断**: 各銘柄に「買い」「様子見」「見送り」を表示

### データソース
- Yahoo Finance APIから直接取得
- リアルタイムに近いデータ（遅延あり）

## ⚙️ カスタマイズ

### ポートフォリオの変更

`Code.gs` の `CONFIG.PORTFOLIO` を編集：
```javascript
PORTFOLIO: {
  "TSLA": {"weight": 20, "name": "Tesla", "sector": "EV・自動運転"},
  // 銘柄を追加・削除
}
```

### 更新頻度の変更

`setupTriggers()` 関数を編集して、トリガーの頻度を調整できます。

## 🔒 セキュリティ

- デフォルトでは「自分のみ」アクセス可能
- 他の人と共有する場合は、デプロイ設定で「全員」に変更
- GitHubトークンは使用せず、公開データのみ取得

## 🐛 トラブルシューティング

### データが表示されない
1. GASのログを確認（表示 → ログ）
2. Yahoo Finance APIの制限を確認
3. 権限設定を確認

### 更新が遅い
- 無料版のGASには実行時間制限があります
- 銘柄数を減らすか、更新頻度を下げてください

### エラーが出る
1. コンソールログを確認
2. ネットワーク接続を確認
3. APIの応答を確認

## 📊 データ履歴（オプション）

自動的にGoogle Sheetsに履歴を保存します：
- 日次の価格データ
- 技術指標の推移
- 投資判断の記録

## 🔄 アップデート

最新版は GitHub から取得：
```
https://github.com/nolargo96/tiker/tree/master/gas
```

---

## よくある質問

**Q: 無料で使えますか？**
A: はい、GASの無料枠内で十分動作します。

**Q: リアルタイムデータですか？**
A: Yahoo Financeの無料データを使用するため、15-20分の遅延があります。

**Q: PCからもアクセスできますか？**
A: はい、同じURLでPCからもアクセス可能です。

**Q: データは保存されますか？**
A: オプションでGoogle Sheetsに自動保存できます。